/**
 * CardAuto.module.css - Diseño Premium Refinado
 * 
 * OBJETIVO: Producto "premium confiable", no marketplace informal
 * 
 * LINEAMIENTOS:
 * - Jerarquía visual clara y refinada
 * - Cards limpias, respirables y consistentes
 * - Paleta sobria (blancos, grises, negro)
 * - Color de acento solo para precio
 * - Performance excelente
 * - Diseño escalable
 * 
 * MEJORAS DE DISEÑO:
 * - Espaciado consistente y unificado
 * - Jerarquía visual mejorada (marca vs modelo)
 * - Tipografía refinada con mejor contraste
 * - Efectos visuales sutiles y elegantes
 * - Responsive mejorado con más breakpoints
 * - Micro-interacciones refinadas
 * 
 * @author Indiana Usados
 * @version 8.0.0 - Diseño Premium Refinado
 */

/* ===== VARIABLES CSS LOCALES ===== */
.card {
    /* Variables de espaciado unificadas */
    --card-padding-base: var(--spacing-3);
    --card-padding-compact: var(--spacing-2);
    --card-gap-base: var(--spacing-3);
    --card-gap-compact: var(--spacing-2);
    
    /* Variables de borde y sombra */
    --card-border-width: 0.5px;
    --card-border-opacity: 0.08;
    --card-border-opacity-hover: 0.15;
    --card-shadow-base: 0 2px 8px rgba(0, 0, 0, 0.08), 0 4px 16px rgba(0, 0, 0, 0.06);
    --card-shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.12), 0 12px 32px rgba(0, 0, 0, 0.08);
    --card-hover-lift: -6px;
    --card-hover-lift-mobile: -4px;
    --card-image-zoom: 1.04;
    
    /* Layout */
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    max-width: 360px;
    
    /* Estilo visual */
    background: var(--color-white);
    border-radius: var(--border-radius-lg);
    border: var(--card-border-width) solid rgba(0, 0, 0, var(--card-border-opacity));
    box-shadow: var(--card-shadow-base);
    
    /* Comportamiento */
    overflow: hidden;
    position: relative;
    margin: 0 auto;
    cursor: pointer;
    /* ✅ REMOVIDO: z-index innecesario que puede crear contexto de apilamiento problemático */
    
    /* Transiciones consolidadas y refinadas */
    transition: 
        transform var(--transition-smooth),
        box-shadow var(--transition-smooth),
        border-color var(--transition-smooth);
}

/* Hover: Efecto flotación refinado */
.card:hover {
    transform: translateY(var(--card-hover-lift));
    border-color: rgba(0, 0, 0, var(--card-border-opacity-hover));
    box-shadow: var(--card-shadow-hover);
}

/* Active: Feedback táctil para mobile */
.card:active {
    transform: translateY(calc(var(--card-hover-lift) * 0.5));
}

/* Focus: Accesibilidad mejorada */
.card:focus {
    outline: 2px solid var(--color-brand-500);
    outline-offset: 2px;
}

.card:focus:not(:focus-visible) {
    outline: none;
}

/* ===== CONTENEDOR DE IMAGEN (FOCO PRINCIPAL) ===== */
/**
 * REFACTORIZADO v9.0.0 - Solución estable para producción
 * 
 * CAMBIOS CRÍTICOS:
 * 
 * 1. ASPECT-RATIO: Define proporción 16/9 sin depender de padding-top hack
 *    - Más semántico y mantenible que padding-top: 56.25%
 *    - Funciona en todos los navegadores modernos
 *    - Evita layout shift (CLS) porque reserva espacio desde el inicio
 *    - ✅ NUEVO: min-height explícito como fallback para navegadores antiguos
 * 
 * 2. FLEX-SHRINK: 0 - CRÍTICO para producción
 *    - Previene que flexbox contraiga el contenedor cuando hay restricciones de altura
 *    - Esencial cuando Cloudinary renderiza wrappers adicionales (placeholder, doble img)
 *    - Sin esto, el contenedor colapsa a height: 0 en producción con lazy loading
 * 
 * 3. CONTAIN: REMOVIDO layout - Solo paint y style
 *    - ⚠️ contain: layout INTERFIERE con aspect-ratio en producción
 *    - contain: layout puede prevenir que aspect-ratio calcule correctamente
 *    - Mantenemos paint y style para optimización sin afectar layout
 *    - En producción/build, contain: layout puede causar que el contenedor no calcule altura
 * 
 * 4. OVERFLOW: hidden - Contiene el zoom y placeholder blur
 *    - Permite que el zoom en hover no se desborde
 *    - Contiene el efecto blur del placeholder
 * 
 * 5. MIN-HEIGHT: Fallback para asegurar altura mínima
 *    - Calculado como: width * (9/16) = 360px * 0.5625 = 202.5px
 *    - Solo se usa si aspect-ratio no está soportado
 *    - Evita colapso completo en edge cases
 */
.card__image-container {
    position: relative;
    overflow: hidden;
    width: 100%;
    
    /* ✅ PROPORCIÓN FIJA: 16/9 - Sin hacks, solo CSS moderno */
    aspect-ratio: 16 / 9;
    
    /* ✅ FALLBACK: Altura mínima calculada para navegadores sin aspect-ratio */
    /* Solo se usa si aspect-ratio no está soportado (navegadores muy antiguos) */
    min-height: calc((100% / 16) * 9);
    min-height: 202.5px; /* Fallback fijo basado en max-width: 360px de la card */
    
    /* ✅ FONDO: Placeholder mientras carga (antes de que aparezca blur) */
    background: var(--color-neutral-50);
    
    /* ✅ CRÍTICO PRODUCCIÓN: Prevenir contracción en flexbox */
    /* Sin esto, en build/producción el contenedor puede colapsar cuando:
     * - Hay wrappers adicionales de Cloudinary (._imageContainer_, ._placeholder_)
     * - Las imágenes están position: absolute (no aportan altura al layout)
     * - El lazy loading se ejecuta en timing diferente */
    flex-shrink: 0;
    
    /* ✅ OPTIMIZACIÓN: Solo paint y style (layout REMOVIDO) */
    /* contain: layout causaba problemas con aspect-ratio en producción */
    /* Mantenemos optimización de paint/style sin interferir con layout */
    contain: paint style;
}

/**
 * IMAGEN DENTRO DEL CONTENEDOR
 * 
 * Selector específico para la clase aplicada vía className prop de CloudinaryImage
 * Compatible con wrappers internos de Cloudinary (._imageContainer_, ._image_, ._placeholder_)
 */
.card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    
    /* ✅ TRANSICIÓN: Solo transform (performance - usa GPU) */
    /* No animamos width/height porque causan reflow costoso */
    transition: transform var(--transition-smooth);
    
    /* ✅ Z-INDEX: Asegurar que esté sobre el placeholder */
    /* Usamos !important solo porque Cloudinary puede inyectar estilos inline */
    z-index: 0 !important;
}

/**
 * SELECTOR UNIVERSAL: Compatible con wrappers internos de Cloudinary
 * 
 * CloudinaryImage renderiza:
 * - <div className="imageContainer"> (wrapper interno)
 *   - <img className="placeholder" /> (blur)
 *   - <img className="image" /> (imagen real)
 * 
 * Este selector asegura que ambos elementos respeten el z-index correcto
 */
.card__image-container [class*="image"],
.card__image-container [class*="placeholder"] {
    z-index: 0 !important;
}

/**
 * ZOOM SUTIL EN HOVER - Optimizado para performance
 * 
 * BUENAS PRÁCTICAS:
 * 1. Solo transform (no width/height) - Usa aceleración GPU
 * 2. Scale pequeño (1.04) - Efecto sutil y performante
 * 3. El overflow: hidden del padre contiene el zoom
 * 4. will-change se activa solo en hover (mejor que siempre activo)
 * 
 * NOTA: will-change se aplica vía CSS en hover, no permanentemente
 * para evitar overhead cuando la card no está siendo interactuada
 */
.card:hover .card__image {
    transform: scale(var(--card-image-zoom));
    /* ✅ OPTIMIZACIÓN: Activar aceleración GPU solo cuando es necesario */
    will-change: transform;
}

/* ===== CUERPO DE LA TARJETA ===== */
.card__body {
    --body-padding-y: var(--card-padding-base);
    --body-padding-x: var(--card-padding-base);
    --body-gap: var(--card-gap-base);
    
    flex: 1;
    /* ✅ CRÍTICO: min-height: 0 permite que flexbox calcule correctamente */
    /* Sin esto, los hijos en flexbox pueden no contraerse correctamente */
    /* Esencial para el cálculo correcto de altura total de la card */
    min-height: 0;
    
    display: flex;
    flex-direction: column;
    gap: var(--body-gap);
    padding: var(--body-padding-y) var(--body-padding-x);
    background: var(--color-white);
    justify-content: space-between;
}

/* ===== CONTENEDOR 1: Logo fijo + Datos con padding ===== */
.container1 {
    --container-border-opacity: 0.06;
    --container-border-radius-top: var(--border-radius-md);
    --logo-space: clamp(75px, 21vw, 120px); /* ✅ Espacio reservado para logo (más grande que el logo) */
    
    position: relative; /* ✅ Para posicionar el logo absolute */
    display: flex;
    flex-direction: row;
    gap: 0;
    width: 100%; /* ✅ Ocupa todo el ancho de la card */
    align-items: flex-start;
    justify-content: flex-start;
    flex-shrink: 0;
    min-height: 0;
    border-right: none;
    border-radius: var(--container-border-radius-top) var(--container-border-radius-top) 0 0;
}

/* Logo con posición fija en esquina superior derecha */
.container1_left {
    position: absolute; /* ✅ Logo fijo, no se mueve */
    top: var(--spacing-1);
    right: 0;
    z-index: 1; /* ✅ Debajo de los datos */
    display: flex;
    align-items: flex-start;
    justify-content: flex-end;
    width: fit-content;
    min-width: 0;
}

.brand_logo {
    --logo-size-base: clamp(75px, 21vw, 110px); /* ✅ Más grandes */
    --logo-opacity: 0.92;
    --logo-opacity-hover: 1;
    
    width: var(--logo-size-base);
    height: var(--logo-size-base);
    display: block;
    object-fit: contain;
    opacity: var(--logo-opacity);
    transition: 
        opacity var(--transition-smooth),
        transform var(--transition-fast);
    transform: scale(1);
}

/* Variantes de tamaño de logo */
.brand_logo_small {
    --logo-size-base: clamp(65px, 18vw, 90px); /* ✅ Más grandes */
    width: var(--logo-size-base);
    height: var(--logo-size-base);
}

.brand_logo_large {
    --logo-size-base: clamp(78px, 21vw, 110px); /* ✅ Sutilmente más chico que antes */
    width: var(--logo-size-base);
    height: var(--logo-size-base);
}

/* Hover: Logo más visible y sutilmente más grande */
.card:hover .brand_logo {
    opacity: var(--logo-opacity-hover);
    transform: scale(1.02);
}

/* Bloque de datos con padding para reservar espacio del logo */
.container1_right {
    flex: 1 1 auto; /* ✅ Ocupa el espacio disponible */
    width: 100%; /* ✅ Ocupa todo el ancho disponible */
    min-width: 0; /* ✅ Permite que se contraiga si es necesario */
    display: flex;
    flex-direction: column;
    gap: 0;
    justify-content: flex-start;
    align-items: flex-start;
    overflow: visible;
    padding-right: var(--logo-space); /* ✅ Reserva espacio para el logo fijo */
    position: relative; /* ✅ Para z-index */
    z-index: 2; /* ✅ Por encima del logo si hay solapamiento */
}

/* FILA 1: Marca + Modelo - Jerarquía mejorada */
.container1_row1 {
    --row-line-height: 1.15;
    --row-gap: var(--spacing-1);
    
    display: flex;
    align-items: baseline;
    justify-content: flex-start;
    gap: var(--row-gap);
    width: 100%;
    flex-wrap: wrap; /* ✅ Permite que el texto se envuelva si es necesario */
    min-width: 0;
    flex-shrink: 0;
    padding-bottom: 0;
    margin-bottom: 0;
    line-height: var(--row-line-height);
    position: relative; /* ✅ Para z-index */
    z-index: 2; /* ✅ Por encima del logo */
}

/* Marca: Más prominente y con mayor peso */
.marca_text {
    --marca-font-size: clamp(1.5rem, 4.8vw, 1.75rem);
    
    font-size: var(--marca-font-size);
    font-weight: var(--font-weight-bold);
    font-family: var(--font-condensed);
    color: var(--color-text-primary);
    letter-spacing: -0.3px;
    flex-shrink: 0;
    white-space: normal; /* ✅ Permite que se envuelva si es necesario */
    position: relative;
    z-index: 2; /* ✅ Por encima del logo */
}

/* Separador: Más sutil */
.marca_modelo_separator {
    --separator-opacity: 0.2;
    --separator-font-size: clamp(1.5rem, 4.8vw, 1.75rem);
    
    font-size: var(--separator-font-size);
    font-weight: var(--font-weight-light);
    font-family: var(--font-condensed);
    color: var(--color-neutral-400);
    opacity: var(--separator-opacity);
    padding: 0 calc(var(--spacing-1) * 0.5);
    flex-shrink: 0;
    position: relative;
    z-index: 2; /* ✅ Por encima del logo */
}

.version_separator {
    font-size: clamp(1.375rem, 4.5vw, 1.625rem);
    font-weight: var(--font-weight-semibold);
    font-family: var(--font-condensed);
    color: var(--color-neutral-500);
    padding: 0 var(--spacing-1);
    flex-shrink: 0;
}

/* Modelo: Ligeramente más pequeño que marca para jerarquía */
.modelo_title {
    --modelo-font-size: clamp(1.4rem, 4.5vw, 1.65rem);
    
    font-size: var(--modelo-font-size);
    font-weight: var(--font-weight-semibold);
    font-family: var(--font-condensed);
    color: var(--color-neutral-600);
    line-height: var(--row-line-height);
    letter-spacing: -0.2px;
    margin: 0;
    text-align: left;
    flex-shrink: 1;
    min-width: 0;
    overflow: visible; /* ✅ Permite que se vea completo */
    text-overflow: clip; /* ✅ Sin ellipsis */
    white-space: normal; /* ✅ Permite que se envuelva */
    position: relative;
    z-index: 2; /* ✅ Por encima del logo */
}

.version_text {
    --version-font-size: clamp(1.4rem, 4.5vw, 1.65rem); /* ✅ Mismo tamaño que modelo */
    
    font-size: var(--version-font-size);
    font-weight: var(--font-weight-semibold);
    font-family: var(--font-condensed);
    color: var(--color-neutral-500); /* ✅ Gris */
    line-height: var(--row-line-height);
    letter-spacing: -0.2px;
    flex-shrink: 1;
    min-width: 0;
    overflow: visible; /* ✅ Permite que se vea completo */
    text-overflow: clip; /* ✅ Sin ellipsis */
    white-space: normal; /* ✅ Permite que se envuelva */
    margin-left: var(--spacing-1); /* ✅ Espacio antes de la versión */
    position: relative;
    z-index: 2; /* ✅ Por encima del logo */
}

/* FILA 2: Versión (debajo de marca y modelo) */
.container1_row2_version {
    display: flex;
    align-items: flex-start;
    justify-content: flex-start;
    width: 100%;
    padding: 0;
    margin: 0;
}

/* FILA 3: Caja, Km, Año - Adaptado al contenido con padding */
.container1_row3 {
    --data-item-padding-right: var(--spacing-3);
    --data-margin-top: var(--spacing-2);
    
    display: flex;
    justify-content: flex-start; /* ✅ Alineados al inicio, se adaptan al contenido */
    align-items: flex-end;
    gap: 0; /* Sin gap, usamos padding en cada item */
    flex-wrap: nowrap;
    width: 100%;
    min-width: 0;
    overflow: visible;
    flex-shrink: 0;
    margin-top: var(--data-margin-top);
    padding-top: 0;
}

/* 
 * NOTA: .container1_row3_automatica no requiere estilos adicionales
 * El padding se maneja individualmente en cada .row2_data_item
 * Si en el futuro se necesita estilo específico para "Automática", agregar aquí
 */

.row2_data_item {
    --data-item-padding-right: var(--spacing-3);
    
    display: flex;
    align-items: flex-end;
    justify-content: flex-start;
    height: 100%;
    flex: 0 0 auto; /* ✅ Se adapta al contenido - no crece ni se distribuye */
    min-width: 0;
    padding-right: var(--data-item-padding-right); /* Padding para separar */
}

/* Caja: Se adapta al contenido */
.row2_data_item:first-child {
    min-width: 0; /* ✅ Sin mínimo, el contenedor padre ya tiene el ancho mínimo */
}

/* Km y Año: También se adaptan al contenido */
.row2_data_item:not(:first-child) {
    min-width: 0; /* Sin mínimo, se adaptan al contenido */
}

/* Cuando "Caja" es "Automática": Más padding si es necesario */
.row2_data_item_automatica {
    padding-right: var(--data-item-padding-right);
}

.row2_data_content {
    display: flex;
    flex-direction: column;
    gap: 0;
    align-items: flex-start;
    justify-content: flex-end;
    text-align: left;
    width: 100%;
}

/* Label: Más legible y con mejor contraste */
.row2_data_label {
    --label-font-size: clamp(0.8125rem, 2.1vw, 0.9375rem);
    --label-letter-spacing: 0.2px;
    
    font-size: var(--label-font-size);
    font-weight: var(--font-weight-medium);
    font-family: var(--font-condensed);
    color: var(--color-neutral-600);
    letter-spacing: var(--label-letter-spacing);
    text-transform: capitalize;
    white-space: nowrap;
    overflow: visible;
    text-overflow: clip;
    margin-bottom: 2px;
}

/* Value: Más legible, peso aumentado ligeramente */
.row2_data_value {
    --value-font-size: clamp(1.25rem, 3.5vw, 1.5rem);
    --value-letter-spacing: -0.3px;
    --value-line-height: 1.25;
    --value-font-weight: 300;
    
    font-size: var(--value-font-size);
    font-weight: var(--value-font-weight);
    font-family: var(--font-condensed);
    color: var(--color-neutral-600); /* Mismo color que las labels */
    line-height: var(--value-line-height);
    letter-spacing: var(--value-letter-spacing);
    width: 100%;
    text-align: left;
    white-space: nowrap;
    overflow: visible;
    text-overflow: clip;
    
    /* Optimización de renderizado de texto fino */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-synthesis: none;
    text-rendering: optimizeLegibility;
}


/* ===== PRECIO DIVIDIDO EN 2 CONTENEDORES ===== */
.container4 {
    --price-border-opacity: 0.05;
    --price-border-radius: var(--border-radius-lg);
    
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: var(--spacing-2);
    margin-top: 0;
    padding-top: 0;
    border-top: 1px solid var(--color-neutral-200);
    border-left: 1px solid rgba(0, 0, 0, var(--price-border-opacity));
    border-radius: var(--price-border-radius) 0 0 0;
}

/* Contenedor izquierda: "Desde:" */
.price_label_container {
    --label-width: 30%;
    --label-padding-left: var(--spacing-2);
    
    flex: 0 0 var(--label-width);
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding: 0;
    padding-left: var(--label-padding-left);
    background: transparent;
}

/* Label "desde": Más legible y menos cursiva */
.price_label {
    --label-font-size: clamp(1.125rem, 2.8vw, 1.375rem);
    
    font-size: var(--label-font-size);
    font-weight: var(--font-weight-medium);
    font-style: normal;
    font-family: var(--font-condensed);
    color: var(--color-neutral-600);
    text-align: left;
    text-transform: lowercase;
    letter-spacing: 0.5px;
}

/* Contenedor derecha: Precio */
.price_display {
    --price-width: 70%;
    --price-padding-right: var(--spacing-3);
    
    flex: 0 0 var(--price-width);
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding: 0;
    padding-top: var(--spacing-1);
    padding-right: var(--price-padding-right);
    background: transparent;
}

/* Precio destacado: Más legible, menos cursiva */
.price_value {
    --price-font-size: clamp(2.125rem, 5.8vw, 2.625rem);
    --price-letter-spacing: -0.4px;
    --price-line-height: 1.15;
    --price-symbol-size: 0.7em;
    
    font-size: var(--price-font-size);
    font-weight: var(--font-weight-bold);
    font-style: normal;
    font-family: var(--font-condensed);
    color: var(--color-brand-500);
    line-height: var(--price-line-height);
    letter-spacing: var(--price-letter-spacing);
    text-align: right;
}

/* Signo de pesos más pequeño */
.price_value::first-letter {
    font-size: var(--price-symbol-size);
}

/* ===== RESPONSIVE - MOBILE FIRST ===== */

/* Mobile: Espaciado más compacto */
@media (max-width: 575px) {
    .card {
        --card-hover-lift: var(--card-hover-lift-mobile);
    }
    
    .card__body {
        --body-padding-y: var(--card-padding-compact);
        --body-padding-x: var(--card-padding-compact);
        --body-gap: var(--card-gap-compact);
    }
    
    .container1 {
        gap: 0; /* ✅ Sin gap intermedio */
    }
    
    .container1_row3 {
        --data-gap: var(--spacing-2);
        --data-margin-top: var(--spacing-1);
    }
}

/* Tablet: Espaciado medio */
@media (min-width: 576px) {
    .card {
        border-radius: var(--border-radius-lg);
    }
    
    .card__body {
        --body-padding-y: var(--card-padding-base);
        --body-padding-x: var(--card-padding-base);
        --body-gap: var(--spacing-4);
    }
    
    .container1 {
        gap: 0; /* ✅ Sin gap intermedio */
    }
    
    .container1_row3 {
        --data-gap: var(--spacing-3);
    }
}

/* Desktop: Espaciado generoso y bordes más redondeados */
@media (min-width: 768px) {
    .card {
        border-radius: var(--border-radius-xl);
    }
    
    .card__body {
        --body-gap: var(--spacing-2);
    }
    
    .container1 {
        gap: 0; /* ✅ Sin gap intermedio */
    }
}

/* ===== ACCESIBILIDAD: REDUCED MOTION ===== */
@media (prefers-reduced-motion: reduce) {
    .card,
    .card__image,
    .brand_logo {
        transition: none;
    }
    
    .card:hover .card__image {
        transform: none;
    }
    
    .card:hover {
        transform: none;
    }
}
